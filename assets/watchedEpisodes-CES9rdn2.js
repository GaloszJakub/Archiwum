import{l as i,n as c,s as w,y as m,z as u,C as n,E as p,G as r,H as h,J as E,K as I}from"./index-BhxVA3-h.js";class b{getEpisodeId(e,t,a){return`${e}_s${t}_e${a}`}async markAsWatched(e,t,a,d){const o=this.getEpisodeId(t,a,d),s=i(c,"users",e,"watchedEpisodes",o);await w(s,{tmdbId:t,seasonNumber:a,episodeNumber:d,watchedAt:m.now()})}async markAsUnwatched(e,t,a,d){const o=this.getEpisodeId(t,a,d),s=i(c,"users",e,"watchedEpisodes",o);await u(s)}async getWatchedEpisodesForShow(e,t){const a=n(c,"users",e,"watchedEpisodes"),d=p(a,r("tmdbId","==",t));return(await h(d)).docs.map(s=>({odcinekId:s.id,tmdbId:s.data().tmdbId,seasonNumber:s.data().seasonNumber,episodeNumber:s.data().episodeNumber,watchedAt:s.data().watchedAt.toDate()}))}async getMostRecentWatchedEpisodes(e,t=50){const a=n(c,"users",e,"watchedEpisodes"),d=p(a,I("watchedAt","desc"),E(t));return(await h(d)).docs.map(s=>({odcinekId:s.id,tmdbId:s.data().tmdbId,seasonNumber:s.data().seasonNumber,episodeNumber:s.data().episodeNumber,watchedAt:s.data().watchedAt.toDate()}))}async isEpisodeWatched(e,t,a,d){const o=this.getEpisodeId(t,a,d);return i(c,"users",e,"watchedEpisodes",o),!(await h(p(n(c,"users",e,"watchedEpisodes"),r("__name__","==",o)))).empty}}const g=new b;export{g as w};
