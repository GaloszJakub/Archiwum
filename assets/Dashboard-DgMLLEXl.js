import{c as z,u as v,a as D,b as C,r as j,j as e,B as o,U as M,S as y,I as U,X as E,A as T,m as W,L as A,F as N,T as f}from"./index-Do5FezME.js";import{S as F}from"./SplitText-BLJnEZkp.js";import{M as m}from"./MovieCard-Dpm8xQvi.js";import{u as L,a as Q,b as R}from"./useTMDB-B4-GA8KA.js";import{w as $}from"./watchedEpisodes-DNUvklX3.js";import{t as d}from"./tmdb-asYHfBOd.js";import{S as O}from"./star-PWIeYpDw.js";import"./AddToCollectionButton-CWatftT8.js";import"./label-qC8oY3ar.js";import"./useCollections-puYkBbMI.js";import"./plus-pGei4JVk.js";const V=z("Shuffle",[["path",{d:"m18 14 4 4-4 4",key:"10pe0f"}],["path",{d:"m18 2 4 4-4 4",key:"pucp1d"}],["path",{d:"M2 18h1.973a4 4 0 0 0 3.3-1.7l5.454-8.6a4 4 0 0 1 3.3-1.7H22",key:"1ailkh"}],["path",{d:"M2 6h1.972a4 4 0 0 1 3.6 2.2",key:"km57vx"}],["path",{d:"M22 18h-6.041a4 4 0 0 1-3.3-1.8l-.359-.45",key:"os18l9"}]]),Y=()=>{const{user:a}=v();return D({queryKey:["recentlyWatched",a?.uid],queryFn:async()=>{if(!a)return[];const i=await $.getMostRecentWatchedEpisodes(a.uid,50),r=new Map;for(const t of i)r.has(t.tmdbId)||r.set(t.tmdbId,{lastWatchedAt:t.watchedAt,seasonNumber:t.seasonNumber,episodeNumber:t.episodeNumber});const l=Array.from(r.keys()).slice(0,6);return(await Promise.all(l.map(async t=>{try{const c=await d.getTVShowDetails(t),n=r.get(t);return{tmdbId:t,name:c.name,posterPath:c.poster_path,lastWatchedAt:n.lastWatchedAt,lastEpisode:{seasonNumber:n.seasonNumber,episodeNumber:n.episodeNumber}}}catch{return null}}))).filter(t=>t!==null)},enabled:!!a,staleTime:300*1e3})},re=()=>{const a=C(),[i,r]=j.useState(""),[l,x]=j.useState(""),{data:t}=L(),{data:c}=Q(),{data:n,isLoading:h}=R(l),{data:u}=Y(),b=t?.pages[0]?.results.slice(0,6)||[],w=c?.pages[0]?.results.slice(0,6)||[],{user:q}=v(),g=n?.pages[0]?.results||[],k=l.trim().length>0;j.useEffect(()=>{const s=setTimeout(()=>{x(i)},500);return()=>clearTimeout(s)},[i]);const S=s=>{s.preventDefault()},_=()=>{r(""),x("")};return e.jsxs("div",{className:"space-y-12",children:[e.jsx("div",{className:"space-y-2",children:e.jsxs("div",{className:"text-center space-y-4",children:[e.jsxs("div",{className:"relative flex items-center justify-center",children:[e.jsx(F,{text:"Panel",className:"text-5xl lg:text-6xl font-bold"}),e.jsx("div",{className:"lg:hidden absolute right-2 top-1/2 -translate-y-1/2 scale-150",children:e.jsx(o,{variant:"ghost",size:"icon",onClick:()=>a("/profile"),className:"rounded-full w-12 h-12",children:e.jsx(M,{className:"w-8 h-8"})})})]}),e.jsx("p",{className:"text-xl text-foreground-secondary max-w-2xl mx-auto",children:"Odkryj najpopularniejsze filmy i seriale"}),e.jsx("form",{onSubmit:S,className:"max-w-2xl mx-auto mt-6",children:e.jsxs("div",{className:"relative",children:[e.jsx(y,{className:"absolute left-4 top-1/2 -translate-y-1/2 w-5 h-5 text-muted-foreground"}),e.jsx(U,{type:"text",placeholder:"Szukaj filmów i seriali...",value:i,onChange:s=>r(s.target.value),className:"pl-12 pr-12 py-6 text-lg bg-background-secondary border-border"}),i&&e.jsx("button",{type:"button",onClick:_,className:"absolute right-4 top-1/2 -translate-y-1/2 text-muted-foreground hover:text-foreground",children:e.jsx(E,{className:"w-5 h-5"})})]})})]})}),e.jsx(T,{children:k&&e.jsxs(W.section,{initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},className:"space-y-6",children:[e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(y,{className:"w-6 h-6 text-primary"}),e.jsxs("h2",{className:"text-3xl font-bold",children:['Wyniki wyszukiwania dla "',l,'"']})]})}),h&&e.jsx("div",{className:"flex items-center justify-center py-16",children:e.jsx(A,{className:"w-8 h-8 animate-spin text-primary"})}),!h&&g.length===0&&e.jsx("div",{className:"text-center py-16 bg-background-secondary rounded-xl",children:e.jsxs("p",{className:"text-foreground-secondary text-lg",children:['Nie znaleziono wyników dla "',l,'"']})}),!h&&g.length>0&&e.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-6 gap-4",children:g.map(s=>{const p=s.media_type==="movie",I=p?s.title:s.name,P=p?s.release_date?new Date(s.release_date).getFullYear():void 0:s.first_air_date?new Date(s.first_air_date).getFullYear():void 0;return e.jsx("div",{onClick:()=>a(p?`/movie/${s.id}`:`/series/${s.id}`),children:e.jsx(m,{id:s.id.toString(),title:I||"Unknown",posterUrl:d.getImageUrl(s.poster_path),year:P,rating:s.vote_average,tmdbId:s.id,type:p?"movie":"tv",posterPath:s.poster_path})},s.id)})})]})}),u&&u.length>0&&e.jsxs("section",{className:"space-y-6",children:[e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(V,{className:"w-6 h-6 text-primary"}),e.jsx("h2",{className:"text-3xl font-bold",children:"Ostatnio Oglądane"})]})}),e.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-6 gap-4",children:u.map(s=>e.jsx("div",{onClick:()=>a(`/series/${s.tmdbId}`,{state:{initialSeason:s.lastEpisode?.seasonNumber,initialEpisode:s.lastEpisode?.episodeNumber}}),children:e.jsx(m,{id:s.tmdbId.toString(),title:s.name,posterUrl:d.getImageUrl(s.posterPath),tmdbId:s.tmdbId,type:"tv",posterPath:s.posterPath})},s.tmdbId))})]}),e.jsxs("section",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(N,{className:"w-6 h-6 text-primary"}),e.jsx("h2",{className:"text-3xl font-bold",children:"Popularne"})]}),e.jsx(o,{variant:"ghost",onClick:()=>a("/movies"),className:"text-primary hover:text-primary-hover",children:"Zobacz wszystkie →"})]}),e.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-6 gap-4",children:b.map(s=>e.jsx("div",{onClick:()=>a(`/movie/${s.id}`),children:e.jsx(m,{id:s.id.toString(),title:s.title||"Unknown",posterUrl:d.getImageUrl(s.poster_path),year:s.release_date?new Date(s.release_date).getFullYear():void 0,rating:s.vote_average,tmdbId:s.id,type:"movie",posterPath:s.poster_path})},s.id))})]}),e.jsxs("section",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(f,{className:"w-6 h-6 text-primary"}),e.jsx("h2",{className:"text-3xl font-bold",children:"Popularne"})]}),e.jsx(o,{variant:"ghost",onClick:()=>a("/series"),className:"text-primary hover:text-primary-hover",children:"Zobacz wszystkie →"})]}),e.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-6 gap-4",children:w.map(s=>e.jsx("div",{onClick:()=>a(`/series/${s.id}`),children:e.jsx(m,{id:s.id.toString(),title:s.name||"Unknown",posterUrl:d.getImageUrl(s.poster_path),year:s.first_air_date?new Date(s.first_air_date).getFullYear():void 0,rating:s.vote_average,tmdbId:s.id,type:"tv",posterPath:s.poster_path})},s.id))})]}),e.jsxs("section",{className:"bg-background-secondary rounded-xl p-8 text-center space-y-4",children:[e.jsx(O,{className:"w-12 h-12 text-primary mx-auto"}),e.jsx("h2",{className:"text-2xl font-bold",children:"Odkryj najlepiej oceniane produkcje"}),e.jsx("p",{className:"text-foreground-secondary max-w-xl mx-auto",children:"Przeglądaj tysiące filmów i seriali z całego świata"}),e.jsxs("div",{className:"flex gap-4 justify-center pt-4",children:[e.jsxs(o,{onClick:()=>a("/movies"),size:"lg",children:[e.jsx(N,{className:"w-5 h-5 mr-2"}),"Filmy"]}),e.jsxs(o,{onClick:()=>a("/series"),variant:"outline",size:"lg",children:[e.jsx(f,{className:"w-5 h-5 mr-2"}),"Seriale"]})]})]})]})};export{re as default};
