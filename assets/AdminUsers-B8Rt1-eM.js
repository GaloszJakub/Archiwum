import{u as g,b,r as i,C as w,n as v,E as k,K as S,H as z,j as e,m as A,af as o,U as m,ag as U}from"./index-BhxVA3-h.js";import{S as L,a as D,b as C,c as E,d as x}from"./select-4oKjeUO7.js";import{C as h}from"./crown-C0_oWNBP.js";const q=()=>{const{isAdmin:l}=g(),n=b(),[d,c]=i.useState([]),[j,p]=i.useState(!0);i.useEffect(()=>{if(!l){n("/");return}f()},[l,n]);const f=async()=>{try{const s=w(v,"users"),a=k(s,S("createdAt","desc")),N=(await z(a)).docs.map(y=>{const t=y.data();return{uid:t.uid,email:t.email,displayName:t.displayName,role:t.role||"user",createdAt:t.createdAt?.toDate()||new Date,lastLogin:t.lastLogin?.toDate()||new Date}});c(N)}catch{}finally{p(!1)}},u=async(s,a)=>{try{await U.updateUserRole(s,a),c(d.map(r=>r.uid===s?{...r,role:a}:r))}catch{alert("Błąd podczas zmiany roli")}};return l?j?e.jsx("div",{className:"flex items-center justify-center min-h-screen",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary"})}):e.jsxs(A.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"space-y-8",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(o,{className:"w-8 h-8 text-primary"}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-4xl font-bold",children:"Zarządzanie użytkownikami"}),e.jsx("p",{className:"text-foreground-secondary",children:"Panel Administratora"})]})]}),e.jsx("div",{className:"bg-background-secondary rounded-xl overflow-hidden",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-background border-b border-border",children:e.jsxs("tr",{children:[e.jsx("th",{className:"text-left p-4 font-semibold",children:"Użytkownik"}),e.jsx("th",{className:"text-left p-4 font-semibold",children:"Email"}),e.jsx("th",{className:"text-left p-4 font-semibold",children:"Rola"}),e.jsx("th",{className:"text-left p-4 font-semibold",children:"Utworzono"}),e.jsx("th",{className:"text-left p-4 font-semibold",children:"Ostatnie logowanie"})]})}),e.jsx("tbody",{children:d.map(s=>e.jsxs("tr",{className:"border-b border-border hover:bg-background/50",children:[e.jsx("td",{className:"p-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 rounded-full bg-primary/20 flex items-center justify-center",children:s.role==="admin"?e.jsx(h,{className:"w-5 h-5 text-primary"}):e.jsx(m,{className:"w-5 h-5 text-foreground-secondary"})}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:s.displayName||"Brak nazwy"}),e.jsxs("p",{className:"text-xs text-foreground-secondary",children:[s.uid.slice(0,8),"..."]})]})]})}),e.jsx("td",{className:"p-4 text-foreground-secondary",children:s.email}),e.jsx("td",{className:"p-4",children:e.jsxs(L,{value:s.role,onValueChange:a=>u(s.uid,a),children:[e.jsx(D,{className:"w-32",children:e.jsx(C,{})}),e.jsxs(E,{children:[e.jsx(x,{value:"user",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(m,{className:"w-4 h-4"}),"User"]})}),e.jsx(x,{value:"admin",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(h,{className:"w-4 h-4"}),"Admin"]})})]})]})}),e.jsx("td",{className:"p-4 text-foreground-secondary text-sm",children:s.createdAt.toLocaleDateString("pl-PL")}),e.jsx("td",{className:"p-4 text-foreground-secondary text-sm",children:s.lastLogin.toLocaleDateString("pl-PL")})]},s.uid))})]})})}),e.jsxs("div",{className:"bg-primary/10 border border-primary/20 rounded-xl p-6",children:[e.jsxs("h3",{className:"font-semibold mb-2 flex items-center gap-2",children:[e.jsx(o,{className:"w-5 h-5"}),"Informacje o rolach"]}),e.jsxs("ul",{className:"space-y-2 text-sm text-foreground-secondary",children:[e.jsxs("li",{children:["• ",e.jsx("strong",{children:"User"})," - Standardowy użytkownik z dostępem do filmów, seriali i kolekcji"]}),e.jsxs("li",{children:["• ",e.jsx("strong",{children:"Admin"})," - Pełny dostęp + zarządzanie użytkownikami"]})]})]})]}):null};export{q as default};
