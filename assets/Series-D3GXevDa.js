import{r as s,b as ae,j as t,B as f,S as re,I as ie,m as j,L as _}from"./index-Do5FezME.js";import{S as oe}from"./SplitText-BLJnEZkp.js";import{M as ne}from"./MovieCard-Dpm8xQvi.js";import{h as le,i as ce,j as o,a as de,k as pe,l as ge}from"./useTMDB-B4-GA8KA.js";import{t as ue}from"./tmdb-asYHfBOd.js";import{S as me,M as i}from"./MediaSection-CVWu1QML.js";import"./AddToCollectionButton-CWatftT8.js";import"./label-qC8oY3ar.js";import"./useCollections-puYkBbMI.js";import"./plus-pGei4JVk.js";const Pe=()=>{const[d,b]=s.useState(""),[a,z]=s.useState(""),[p,N]=s.useState(!1),[n,g]=s.useState(""),[l,L]=s.useState(""),[u,M]=s.useState("popularity.desc"),S=s.useRef(null),T=ae(),{data:k}=le(),w=n||l||u!=="popularity.desc",m=a||w,{data:D,isLoading:F,error:C,fetchNextPage:A,hasNextPage:I,isFetchingNextPage:E}=ce(a),{data:G,isLoading:R,error:V,fetchNextPage:B,hasNextPage:$,isFetchingNextPage:Q}=o({with_genres:n,sort_by:u,year:l?parseInt(l):void 0}),{data:Y,isLoading:U}=de(),{data:W,isLoading:K}=pe(),{data:O,isLoading:H}=ge(),{data:Z}=o({with_genres:"10765"}),{data:q}=o({with_genres:"80"}),{data:J}=o({with_genres:"35"}),{data:xe}=o({with_genres:"18"}),{data:X}=o({with_genres:"16"}),{data:ee}=o({with_genres:"99"}),x=a?D?.pages.flatMap(e=>e.results)||[]:G?.pages.flatMap(e=>e.results)||[],c=a?F:R,h=a?C:V,P=a?A:B,v=a?I:$,y=a?E:Q;s.useEffect(()=>{const e=setTimeout(()=>{z(d)},500);return()=>clearTimeout(e)},[d]),s.useEffect(()=>{if(!m)return;const e=new IntersectionObserver(se=>{se[0].isIntersecting&&v&&!y&&P()},{threshold:.1}),r=S.current;return r&&e.observe(r),()=>{r&&e.unobserve(r)}},[m,v,y,P]);const te=e=>{g(e),b(""),p||N(!0)};return t.jsxs("div",{className:"space-y-8 pb-20",children:[t.jsxs("div",{className:"space-y-4",children:[t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsx(oe,{text:"Seriale",className:"text-3xl lg:text-5xl font-bold"}),t.jsx(f,{variant:"outline",size:"icon",onClick:()=>N(!p),className:`bg-background-secondary border-border hover:bg-secondary shrink-0 ${w?"text-primary border-primary":""}`,children:t.jsx(me,{className:"w-4 h-4"})})]}),t.jsxs("div",{className:"relative w-full",children:[t.jsx(re,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-foreground-secondary"}),t.jsx(ie,{type:"text",placeholder:"Szukaj seriali...",value:d,onChange:e=>b(e.target.value),className:"pl-10 bg-background-secondary border-border w-full"})]}),t.jsxs("div",{className:"flex gap-2 overflow-x-auto pb-2 scrollbar-hide",children:[t.jsx(f,{variant:n===""?"default":"outline",size:"sm",onClick:()=>g(""),className:"shrink-0",children:"Wszystkie"}),k?.genres.map(e=>t.jsx(f,{variant:n===e.id.toString()?"default":"outline",size:"sm",onClick:()=>te(e.id.toString()),className:"shrink-0",children:e.name},e.id))]})]}),p&&t.jsx(j.div,{initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},className:"bg-background-secondary rounded-lg p-4 border border-border",children:t.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[t.jsxs("div",{children:[t.jsx("label",{className:"text-sm text-foreground-secondary mb-2 block",children:"Gatunek"}),t.jsxs("select",{className:"w-full bg-background border border-border rounded-md px-3 py-2 text-sm text-foreground",value:n,onChange:e=>g(e.target.value),children:[t.jsx("option",{value:"",children:"Wszystkie"}),k?.genres.map(e=>t.jsx("option",{value:e.id.toString(),children:e.name},e.id))]})]}),t.jsxs("div",{children:[t.jsx("label",{className:"text-sm text-foreground-secondary mb-2 block",children:"Rok"}),t.jsxs("select",{className:"w-full bg-background border border-border rounded-md px-3 py-2 text-sm text-foreground",value:l,onChange:e=>L(e.target.value),children:[t.jsx("option",{value:"",children:"Wszystkie"}),Array.from({length:30},(e,r)=>new Date().getFullYear()-r).map(e=>t.jsx("option",{value:e.toString(),children:e},e))]})]}),t.jsxs("div",{children:[t.jsx("label",{className:"text-sm text-foreground-secondary mb-2 block",children:"Sortowanie"}),t.jsxs("select",{className:"w-full bg-background border border-border rounded-md px-3 py-2 text-sm text-foreground",value:u,onChange:e=>M(e.target.value),children:[t.jsx("option",{value:"popularity.desc",children:"Najpopularniejsze"}),t.jsx("option",{value:"vote_average.desc",children:"Najlepiej oceniane"}),t.jsx("option",{value:"first_air_date.desc",children:"Najnowsze"}),t.jsx("option",{value:"name.asc",children:"Alfabetycznie A-Z"})]})]})]})}),m?t.jsxs(t.Fragment,{children:[c&&t.jsx("div",{className:"flex items-center justify-center py-16",children:t.jsx(_,{className:"w-8 h-8 animate-spin text-primary"})}),h&&t.jsx("div",{className:"text-center py-16",children:t.jsx("p",{className:"text-foreground-secondary mb-4",children:"Błąd podczas ładowania seriali. Sprawdź klucz API."})}),!c&&!h&&x.length>0&&t.jsx(j.div,{className:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-5 xl:grid-cols-6 gap-4",initial:"hidden",animate:"visible",variants:{hidden:{opacity:0},visible:{opacity:1,transition:{staggerChildren:.05}}},children:Array.from(new Map(x.map(e=>[e.id,e])).values()).map((e,r)=>t.jsx(j.div,{variants:{hidden:{opacity:0,y:20},visible:{opacity:1,y:0}},onClick:()=>T(`/series/${e.id}`),children:t.jsx(ne,{id:e.id.toString(),title:e.name||"Unknown",posterUrl:ue.getImageUrl(e.poster_path),year:e.first_air_date?new Date(e.first_air_date).getFullYear():void 0,rating:e.vote_average,layoutId:`series-${e.id}`,tmdbId:e.id,type:"tv",posterPath:e.poster_path})},`${e.id}-${r}`))}),!c&&!h&&x.length===0&&t.jsx("div",{className:"text-center py-16",children:t.jsx("p",{className:"text-foreground-secondary mb-4",children:"Nie znaleziono seriali dla podanych kryteriów."})}),v&&!c&&t.jsx("div",{ref:S,className:"flex justify-center py-8",children:y&&t.jsx(_,{className:"w-6 h-6 animate-spin text-primary"})})]}):t.jsxs("div",{className:"space-y-12",children:[t.jsx(i,{title:"Popularne teraz",items:Y?.pages.flatMap(e=>e.results)||[],type:"tv",isLoading:U}),t.jsx(i,{title:"Emitowane obecnie",items:W?.pages.flatMap(e=>e.results)||[],type:"tv",isLoading:K}),t.jsx(i,{title:"Najlepiej oceniane",items:O?.pages.flatMap(e=>e.results)||[],type:"tv",isLoading:H}),t.jsx(i,{title:"Sci-Fi & Fantasy",items:Z?.pages.flatMap(e=>e.results)||[],type:"tv"}),t.jsx(i,{title:"Kryminał",items:q?.pages.flatMap(e=>e.results)||[],type:"tv"}),t.jsx(i,{title:"Komedia",items:J?.pages.flatMap(e=>e.results)||[],type:"tv"}),t.jsx(i,{title:"Animacje",items:X?.pages.flatMap(e=>e.results)||[],type:"tv"}),t.jsx(i,{title:"Dokumentalne",items:ee?.pages.flatMap(e=>e.results)||[],type:"tv"})]})]})};export{Pe as default};
